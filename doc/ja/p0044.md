\[[<](./p0043.md)] \[[^](../README_ja.md)] \[[>](./p0045.md)]

# Problem 44: Pentagon Numbers

## The link to the problem

- [Pentagon Numbers](https://projecteuler.net/problem=44)

## My approach

掲示板に投稿した[記事](https://projecteuler.net/action=redirect;post_id=397565)の要約です。

$P_{j}$ と $P_{k} \ (j < k)$ を五角数とし、
$k$ が小さい順番に条件を満たす $P_{j}, \ P_{k}$ を 4 組あげたものが下記の表である(解答はマスクして伏せました)。

$$
\begin{array}{cc|cc}
\hline
P_{j} & P_{k} & P_{k} - P_{j} & P_{k} + P_{j} \\
\hline
P_{aaa}  &  P_{bbb}  &  P_{xxx}  & P_{yyy} \\
P_{52430}  &  P_{91650}  &  P_{75172}  &  P_{105587} \\
P_{95506}  &  P_{110461}  &  P_{55500}  &  P_{146024} \\
P_{111972}  &  P_{121168}  &  P_{46303}  &  P_{164983} \\
\hline
\end{array}
$$

$P_{k}$ や $P_{k} + P_{j}$ が小さい順に条件を満たす五角数のペアを探すと最初に見つかったペアの差が最小なのは確かですが、この探し方では最初に見つかったペアの差が最小の差であるということは保証されていません。
言い直すと、正しい答えが偶然見つかっただけです。

実際に上記の表を見ると、この探し方で 2 番目に見つかるペア $P_{52430}$ と $P_{91650}$ の差 $P_{75172}$ は表の中で一番大きい差になります。
つまり、これは差が小さい順番にペアを見つけることができない探し方です。最初に見つかったペアの差が最小であることを確認するには、
確認作業を継続しなければなりません(かなり大きい五角数まで調べる必要があります)。
そのため、他の手段を検討します。

五角数 $P_{j}, \ P_{k}, \ P_{d}$ が $P_{d} = P_{k} - P_{j} \ (j < k)$ を満たすと仮定し、
$P_{d}$ が小さい順にペア $P_{j}, P_{k}$ を探します。そのようなペアが見つかったら、和 $P_{k} + P_{j}$ が五角数であるか否かをチェックします。

#### Method 1

$x = k - j$ と仮定すると

$$
\begin{align}
P_{d} & = P_{k} - P_{j} \\
      & = P_{x+j} - P_{j} \\
      & = \frac{6jx + 3x^{2} - x}{2} \\
      & = 3jx + P_{x} \\
\therefore j & = \frac{P_{d} - P_{x}}{3x}
\end{align}
$$

明らかに $0 < x < d$ 。上記の式を使えば差 $P_{d}$ が小さい順に条件を満たすペアを探すことができる。
$k$ ではなく $j$ を置換しても良いのですが、上記の様なきれいな式になりません。

#### Method 2

$$
\begin{aligned}
P_{d} & = P_{k} - P_{j} \\\
\Leftrightarrow d(3d-1) & = k(3k-1) - j(3j-1) \\\
        & = (k-j)(3(k+j) - 1)
\end{aligned}
$$

こちらも明らかに $0 < k-j < d$。こちらの式を使うと Method 1 よりも速くペアを探すことができる。

