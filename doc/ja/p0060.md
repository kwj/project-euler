\[[<](./p0059.md)] \[[^](../README_ja.md)] \[[>](./p0061.md)]

# Problem 60: Prime Pair Sets

## The link to the problem

- [Prime Pair Sets](https://projecteuler.net/problem=60)

## My approach

この問題で重要なのは求めた答えが最小であることを保証することです。

実際に小さな素数から順に使ってペアとなる条件を満たす 5 個の素数集合を探してみると、10000 未満の素数で集合を見つけることができます。
この集合の要素の和は約 26000 です(答えなので具体的な数字は伏せます)。
さて、この和を $X$ とおきます。問題文より、条件を満たす 4 個の素数集合の和は 792 であることがわかります。
つまり $X$ が条件を満たす 5 個の素数集合の要素の最小和であることを確認するには、少なくとも $X - 792$ 以下の素数を全て調べる必要があるわけです。

つまり小さい素数から調べて、最初に条件を満たす 5 個の素数集合が見つかった時点で処理を打ち切るのは答えが最小であることを確認していません。
この問題は条件を満たす 5 個の素数集合のうち要素の和が最小なものを探すのであって、要素の最大値が最小なものを探すのではありません。
後者なら最初に見つかった時点で処理を終了するのが正解ですが、残念ながら本問題では不正解です。

FYI: 2, 5 が対象にならないのは明らかですが、3 を除いて素数を 3 の剰余でグループ分けして処理すると計算量を減らせます。
具体的には余りが 1 と 2 のグループに分かれるので、異なるグループの素数で連結したものは 3 の倍数になります。
つまりグループの中でだけ連結を確認すれば良くなります。
